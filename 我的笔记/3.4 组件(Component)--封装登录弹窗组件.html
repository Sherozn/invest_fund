<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 7.12 (457935)"/><meta name="author" content="1369822836@qq.com"/><meta name="created" content="2019-09-13 13:20:48 +0000"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2019-09-16 07:39:40 +0000"/><title>3.4 组件(Component)--封装登录弹窗组件</title></head><body><div><font style="font-size: 14px;"><span style="orphans: 2; widows: 2; font-size: 14px; color: rgb(64, 64, 64); font-family: -apple-system, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Segoe UI&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;">组件 (Component) 是 Vue.js 最强大的功能之一。用来封装可重用的代码或者封装一个单独的模块，比如我们上一节的登录弹窗，下面我们来演示一下如何将</span><span style="font-size: 14px; color: rgb(64, 64, 64);">代码提取到组件</span></font></div><div><font style="font-size: 14px;"><br/></font></div><div><span style="font-size: 14px; color: rgb(64, 64, 64);">1、创建组件</span></div><div><span style="font-size: 14px; color: rgb(64, 64, 64);">在src/components文件夹下面创建一个LoginWindow.vue文件</span></div><div><span style="font-size: 14px; color: rgb(64, 64, 64);">写入vue基础代码</span></div><div><span style="font-size: 16px;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div>&lt;template&gt;</div><div>  &lt;div&gt;</div><div>    登录弹窗组件</div><div>  &lt;/div&gt;</div><div>&lt;/template&gt;</div><div><div><br/></div></div><div>&lt;script&gt;</div><div>export default {</div><div>}</div><div>&lt;/script&gt;</div><div><div><br/></div></div><div>&lt;style lang='scss'&gt;</div><div>&lt;/style&gt;</div></div></span></div><div><span style="font-size: 16px; orphans: 2; widows: 2;"><br/></span></div><div><span style="font-size: 14px;">2、添加样式代码</span></div><div><span style="font-size: 14px;">将index.vue文件中上一节课添加的样式代码，剪切到我们刚刚创建的</span><span style="font-size: 14px; color: rgb(64, 64, 64);">LoginWindow.vue文件中。</span><span style="font-size: 14px; color: rgb(64, 64, 64);">注意是</span><span style="font-size: 14px; color: rgb(64, 64, 64);">剪切哦~</span></div><div><span style="color: rgb(64, 64, 64);">剪切到</span><span style="font-size: 14px; color: rgb(64, 64, 64);">LoginWindow.vue文件中的</span><span style="color: rgb(64, 64, 64);">&lt;style lang='scss'&gt;</span><span style="color: rgb(64, 64, 64);">&lt;/style&gt;</span><span style="font-size: 14px;">标签中</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div>.modal-mask {</div><div>  width: 100%;</div><div>  height: 100%;</div><div>  position: fixed;</div><div>  top: 0;</div><div>  left: 0;</div><div>  background: #000;</div><div>  opacity: 0.5;</div><div>  overflow: hidden;</div><div>  z-index: 9000;</div><div>  color: #fff;</div><div>}</div><div>.modal-dialog {</div><div>  box-sizing: border-box;</div><div>  width: 560rpx;</div><div>  overflow: hidden;</div><div>  position: fixed;</div><div>  top: 30%;</div><div>  left: 0;</div><div>  z-index: 9999;</div><div>  background: #fff;</div><div>  margin: -150rpx 95rpx;</div><div>  border-radius: 16rpx;</div><div>}</div><div>.modal-content {</div><div>  box-sizing: border-box;</div><div>  display: flex;</div><div>  padding: 0rpx 53rpx 50rpx 53rpx;</div><div>  font-size: 32rpx;</div><div>  align-items: center;</div><div>  justify-content: center;</div><div>  flex-direction: column;</div><div>}</div><div>.content-tip {</div><div>  text-align: center;</div><div>  font-size: 36rpx;</div><div>  color: #333333;</div><div>}</div><div>.content-text {</div><div>  height:130px;</div><div>  padding:10px 0px 50px 0px;</div><div>  font-size:14px;</div><div>}</div><div>.modal-footer {</div><div>  box-sizing: border-box;</div><div>  display: flex;</div><div>  flex-direction: row;</div><div>  border-top: 1px solid #e5e5e5;</div><div>  font-size: 16px;</div><div>  font-weight:bold;</div><div>  height: 45px;</div><div>  line-height: 45px;</div><div>  text-align: center;</div><div>  background:#feb600;</div><div>}</div><div>button {</div><div>  width: 100%;</div><div>  background:#feb600;</div><div>  color:#FFFFFF;</div><div>  font-weight:bold;</div><div>}</div><div>.img {</div><div>  width: 280px;</div><div>  height:90px;</div><div>}</div><div>.little-tip {</div><div>  padding-top:15px;</div><div>  padding-bottom:3px;</div><div>  font-size: 14px;</div><div>  font-weight:bold;</div><div>  color: #feb600;</div><div>}</div><div>.little-content {</div><div>  padding-top:5px;</div><div>  font-size: 13px;</div><div>  color:#606060;</div><div>}</div><div>.key-bold {</div><div>  padding-top:5px;</div><div>  font-size: 14px;</div><div>  font-weight:bold;</div><div>}</div></div><div><font style="font-size: 14px;"><br/></font></div><div><span style="font-size: 14px;">3、编辑script部分</span></div><div><span style="font-size: 14px;">（1）在</span><span style="font-size: 14px; color: rgb(64, 64, 64);">LoginWindow.vue文件中</span><span style="font-size: 14px;">&lt;</span><span style="font-size: 14px;">script&gt;&lt;/</span><span style="font-size: 14px;">script&gt;标签内</span><span style="font-size: 14px;">添加methods对象，并将index.vue文件中的登录方法剪切到</span><span style="font-size: 14px;">methods对象中</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div>//参考代码，无需粘贴</div><div>//&lt;script&gt;</div><div>//export default {</div><div>//methods: {</div><div><br/></div><div><br/></div><div>    //需要剪切粘贴的部分，从index.vue剪切到LoginWindow.vue文件</div><div>    loginSuccess (res) {</div><div>      //将用户信息保存到缓存中，wx.setStorageSync是小程序的一个API，用来将信息添加到缓存中</div><div>      wx.setStorageSync('userinfo', res)</div><div>    },</div><div>    login () {</div><div>      //wx.showToast是小程序的消息提示框API</div><div>      wx.showToast({</div><div>        title: '登录中',</div><div>        icon: 'loading'</div><div>      })</div><div>      //通过SDK插件，请求config.js中配置的loginUrl路径（http://localhost:5757/weapp/login）</div><div>      qcloud.setLoginUrl(config.loginUrl)</div><div>      qcloud.login({</div><div>        success: res =&gt; {</div><div>          //登录成功后，显示底部导航栏</div><div>          wx.showTabBar()</div><div>          console.log('登录成功', res)</div><div>          //调用loginSuccess方法，并将用户信息作为参数</div><div>          this.loginSuccess(res)</div><div>        },</div><div>        fail: err =&gt; {</div><div>          console.error('登录失败', err)</div><div>        }</div><div>      })</div><div>    }</div><div>  </div><div><br/></div><div>  //参考代码，无需粘贴</div><div>  //}</div><div>//}</div><div>//&lt;/script&gt;</div></div><div><font style="font-size: 14px;"><br/></font></div><div>（2）import引用语句</div><div>将import引用SDK插件、config.js语句剪切到<span style="font-size: 14px; color: rgb(64, 64, 64);">LoginWindow.vue文件中</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div>//参考代码，无需粘贴</div><div>//&lt;script&gt;</div><div><div><br/></div></div><div><br/></div><div>  //需要粘贴的部分</div><div>  import qcloud from 'wafer2-client-sdk'</div><div>  import config from '@/config'</div><div>  </div><div><div><br/></div></div><div>  //参考代码，无需粘贴</div><div>  //export default {</div></div><div><font style="font-size: 14px;"><br/></font></div><div><span style="font-size: 14px;">4、编辑template部分</span></div><div><span style="font-size: 14px;">将登录弹窗部分的页面代码也剪切到</span><span style="font-size: 14px; color: rgb(64, 64, 64);">LoginWindow.vue文件中</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div>&lt;!-- 参考代码，无需粘贴</div><div>&lt;template&gt;</div><div>  &lt;div&gt; --&gt;</div><div><br/></div><div><br/></div><div>    &lt;!--需要剪切粘贴的部分--&gt;</div><div>    &lt;div class="modal-mask"&gt;</div><div>    &lt;/div&gt;</div><div>    &lt;div class="modal-dialog"&gt;</div><div>      &lt;div class="modal-content"&gt;</div><div>        &lt;img class="img" src="/static/images/littleTip-huang.jpg"&gt;</div><div>        &lt;div class="content-text"&gt;</div><div>          &lt;p class="key-bold"&gt;真自律是一款自律神器。&lt;/p&gt;</div><div>          &lt;p class="key-bold"&gt;将生活想象成通关打怪，打败自己的心魔加分，被心魔打败减分。&lt;/p&gt;</div><div>          &lt;p class="little-tip"&gt;举个例子：&lt;/p&gt;</div><div>          &lt;p class="little-content"&gt;</div><div>            午饭忍住没有吃麻辣烫，吃的绿色蔬菜，加5分；</div><div>          &lt;/p&gt;</div><div>          &lt;p class="little-content"&gt;</div><div>            但是晚饭还是没有忍住T_T，罪恶罪恶，减10分。</div><div>          &lt;/p&gt;</div><div>        &lt;/div&gt;</div><div>      &lt;/div&gt;</div><div>      &lt;div class="modal-footer"&gt;</div><div>         &lt;!-- 小程序集成的API，通过button来授权登录 --&gt;</div><div>         &lt;button open-type="getUserInfo" lang="zh_CN" class='btn' @getuserinfo="login"&gt;授权登录&lt;/button&gt;</div><div>      &lt;/div&gt;</div><div>    &lt;/div&gt;</div><div>  </div><div><br/></div><div>&lt;!-- 参考代码，无需粘贴</div><div>  &lt;/div&gt;</div><div>&lt;/template&gt; --&gt;</div></div><div><font style="font-size: 14px;"><br/></font></div><div><font style="font-size: 14px;"><br/></font></div><div><span style="font-size: 14px;">5、编辑index.vue文件</span></div><div>（1）在index.vue文件中关联组件</div><div>通过import引入组件，并添加components对象声明组件</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div>//参考代码，无需粘贴</div><div>//&lt;script&gt;</div><div><div><br/></div></div><div><div><br/></div></div><div>  //需要粘贴的部分，通过import引入组件</div><div><div>  import LoginWindow from '@/components/LoginWindow'</div><div><br/></div><div><br/></div></div><div>  //参考代码，无需粘贴</div><div>  //export default {</div><div><br/></div><div>    </div><div>    //需要粘贴的部分，添加components对象声明组件</div><div>    components: {</div><div>      LoginWindow</div><div>    },</div><div><br/></div><div><br/></div><div>    //参考代码，无需粘贴</div><div>    data () {</div></div><div><font style="font-size: 14px;"><br/></font></div><div><font style="font-size: 14px;"><br/></font></div><div><span style="font-size: 14px;">（2）编辑template部分，添加以组件命名的</span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(64, 64, 64); font-family: -apple-system, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Segoe UI&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">HTML元素</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902);-en-codeblock:true;"><div>&lt;!-- 参考代码，无需粘贴</div><div>&lt;template&gt;</div><div>  &lt;div&gt; —&gt;</div><div><div><br/></div><div><br/></div></div><div><div>  &lt;!-- 需要粘贴的部分 --&gt;</div><div>  &lt;LoginWindow&gt;&lt;/LoginWindow&gt;</div></div><div><div><br/></div></div><div><div><br/></div></div><div>    &lt;!-- 参考代码，无需粘贴</div><div>    &lt;div class="show"&gt; --&gt;</div></div><div><font style="font-size: 14px;"><br/></font></div><div><span style="font-size: 14px;">6、查看效果</span></div><div><span style="font-size: 13px;">在终端启动项目，微信开发者工具会出现与上一节一样的效果</span></div><div><img src="3.4%20%E7%BB%84%E4%BB%B6(Component)--%E5%B0%81%E8%A3%85%E7%99%BB%E5%BD%95%E5%BC%B9%E7%AA%97%E7%BB%84%E4%BB%B6.html.resources/4E45164E-C80A-44B2-A1E6-E3288A554772.png" height="668" width="375"/><br/></div><div><font style="font-size: 14px;"><br/></font></div><div><span style="font-size: 16px;"><br/></span></div></body></html>